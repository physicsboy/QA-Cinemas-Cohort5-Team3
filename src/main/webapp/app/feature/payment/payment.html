<div ng-controller="paymentController as payCtrl">

    <script>
        function trclick() {
            console.log('tr clicked')
        }
        ;
        function tdclick(event, seat) {
            console.log('td clicked', seat);
            selectSeat(seat);


            event.stopPropagation()
        }
        ;
    </script>


    <div class="softwhite">
        <h1>Booking Tickets for</h1>
        <table class="table">
            <tr>
                <th>Film</th>
                <th>Date</th>
                <th>Time</th>
            </tr>
            <tr>
                <td>{{payCtrl.showingTitle}}</td>
                <td>{{payCtrl.showing.dateShowing | date:' EEEE dd/MM '}}</td>
                <td>{{payCtrl.showing.dateShowing | date:'HH:mm '}}</td>
            </tr>
        </table>
    </div>

    <form name="paymentForm" class="softwhite">
        <div class="container-fluid">
            <span class="col-md-6">Enter User Email<input id="user" ng-model="set.user"
                                                          ng-change="payCtrl.update('user',set.user)"></span>
            <span class="col-md-6">Enter Paypal Email<input id="paypal" ng-model="set.paypal"
                                                            ng-change="payCtrl.update('paypal',set.paypal)"></span>

            <div class="col-md-3">
                Adult: <select id="adultDropDown" ng-model="set.adult"
                               ng-options="option.value for option in payCtrl.options"
                               ng-change="payCtrl.update('adult',set.adult)">
            </select>
            </div>

            <div class="col-md-3">
                Child: <select id="childDropDown" ng-model=" set.child"
                               ng-options="option.value for option in payCtrl.options"
                               ng-change="payCtrl.update('child',set.child)">
            </select>
            </div>

            <div class="col-md-3">
                Concession: <select id="consDropDown" ng-model="set.cons"
                                    ng-options="option.value for option in payCtrl.options"
                                    ng-change="payCtrl.update('cons',set.cons)">
            </select>
            </div>

            <div class="col-md-3">
                Premium: <select id="premDropDown" ng-model=" set.prem"
                                 ng-options="option.value for option in payCtrl.options"
                                 ng-change="payCtrl.update('prem',set.prem)">
            </select>
            </div>
        </div>
    </form>
    <div class="clearfix">
        <table id="totalTable" class="table softwhite" style="float:left;border: none">
            <tr>
                <th>User Email Valid?</th>
                <th>PayPal Email Valid?</th>
                <th>At least One Ticket?</th>
            </tr>
            <tr>
                <td><img id="uEVerified" src="_images/cross.png" width="80"></td>
                <td><img id="pEVerified" src="_images/cross.png" width="80"></td>
                <td><img id="nonZeroTickets" src="_images/cross.png" width="80"></td>
            </tr>
        </table>
        <div id="buttonHolder"><div class="gobutton softwhite" id="paypal-button" style="float:right"></div>
            <div style="font-weight: bold">
                Final Price : &pound;{{payCtrl.total}}

            </div>
        </div>


    </div>

    <div id="tableHolder">
        <div class="table-container" id="seatSel" style="width:800px">
            <div class="col-md-6" ng-repeat="v in [0,1,2,3] | limitTo:payCtrl.screen.block.colCount">
                </br>
                <table style="width:400px; table-layout: fixed; margin-bottom:0"
                       class="table  table-bordered table-hover"
                       ng-repeat="i in [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19] | limitTo:payCtrl.screen.block.colCount:block.rowCount ">
                    <tr ng-repeat="block in payCtrl.screen.blocks | limitTo:1:v">
                        <td ng-model="thisSeat" class="outertd"
                            ng-repeat="seat in block.seats | limitTo:block.colCount:block.colCount*i"
                            ng-class="{taken: payCtrl.checkSeatTaken(seat),selected: payCtrl.checkSeatSelected(seat)}">
                            <div class="innertd" ng-click=payCtrl.click(seat)>
                                {{seat.row}}{{seat.column}}
                            </div>
                        </td>
                    </tr>
                </table>

            </div>
        </div>
    </div>


    <div class="softwhite">
        <h3>Subtotal</h3>
        <table class="table">
            <tr>
                <td colspan="4"> Adult Tickets (x{{payCtrl.numAdults}})</td>
                <td class="money"> &pound;{{payCtrl.numAdults*9.99}}</td>
            </tr>
            <tr>
                <td colspan="4"> Child Tickets (x{{payCtrl.numChild}})</td>
                <td class="money"> &pound;{{payCtrl.numChild*5.99}}</td>
            </tr>
            <tr>
                <td colspan="4"> Concession Tickets
                    (x{{payCtrl.numCons}})
                </td>
                <td class="money"> &pound;{{payCtrl.numCons*7.49}}</td>
            </tr>
            <tr>
                <td colspan="4"> Premium Tickets (x{{payCtrl.numPremium}})</td>
                <td class="money"> &pound;{{payCtrl.numPremium*12.99}}</td>
            </tr>
            <tr>
                <td colspan="4"></td>
                <td id="total" class="money">Total Price &pound;{{payCtrl.total}}</td>
            </tr>

        </table>

    </div>

</div>
<style>

    #totalTable {
        -webkit-transition: 1s;
        -moz-transition: 1s;
        -o-transition: 1s;
        transition: 1s;
        width: 100%

    }

    #totalTable.available {
        -webkit-transition: 1s;
        -moz-transition: 1s;
        -o-transition: 1s;
        transition: 1s;
        width: 79% !important;
    }

    #paypal {
        background: #9f2a27;
    }

    #user {
        background: #9f2a27;
    }

    .container-fluid {
        width: 80%;
        margin-left: auto;
        margin-right: auto;
    }

    .softwhite {
        background: rgba(255, 255, 255, 0.4);
        border-radius: 10px;
        padding: 10px 10px;
        margin: 5px 0 !important;
    }

    .money {
        text-align: right;
        font-size: 1.2em;
        font-weight: bold;
        border-left: 1px solid #ffffff;
        width: 20%
    }

    #total {
        font-weight: bolder;
        font-size: 1.6em;
    }

    .clearfix::after {
        content: "";
        clear: both;
        display: table;
    }

    .table {
        border-collapse: separate;

    }

    .gobutton {
        width: 1px;
        height: 1px;
        visibility: hidden;
        -webkit-transition: 1s;
        -moz-transition: 1s;
        -o-transition: 1s;
        transition: 1s;
        opacity: 0;
        padding-top: 30px;
        padding-bottom: 30px;
    }

    .gobutton.available {

        -webkit-transition: 1s;
        -moz-transition: 1s;
        -o-transition: 1s;
        transition: 1s;
        height: 154px !important;
        width: 20% !important;
        opacity: 1 !important;
    }

    #seatSel {
        width: 1px;
        height: 1px;
        visibility: hidden;
        -webkit-transition: 1s;
        -moz-transition: 1s;
        -o-transition: 1s;
        transition: 1s;
        opacity: 0;
        padding-top: 30px;
        padding-bottom: 30px;
    }

    #seatSel.available {

        -webkit-transition: 1s;
        -moz-transition: 1s;
        -o-transition: 1s;
        transition: 1s;
        opacity: 1 !important;
    }

    .table {
        background-color: grey;
    }

    .table-hover > tbody > tr > td:hover, .table-hover > tbody > tr > td:hover {
        background-color: blue;
        -webkit-transition: 0.25s;
        -moz-transition: 0.25s;
        -o-transition: 0.25s;
        transition: 0.25s;

    }

    .taken {
        background: #ff0000 !important;
        cursor: not-allowed;
        -webkit-transition: 0.25s;
        -moz-transition: 0.25s;
        -o-transition: 0.25s;
        transition: 0.25s;
    }

    .taken:hover {
        background: #ff0000 !important;
        -webkit-transition: 0.25s;
        -moz-transition: 0.25s;
        -o-transition: 0.25s;
        transition: 0.25s;
    }

    .selected {
        background: #00ff00;
        -webkit-transition: 0.25s;
        -moz-transition: 0.25s;
        -o-transition: 0.25s;
        transition: 0.25s;

    }

    .selected:hover {
        background: #a5d99b !important;
        -webkit-transition: 0.25s;
        -moz-transition: 0.25s;
        -o-transition: 0.25s;
        transition: 0.25s;

    }

    td {
        cursor: pointer;
        text-align: center;
    }

    .outertd {
        padding: 0 !important;
        height: 20px !important;
        width: 20px !important;
        border-radius: 3px;
    }

    .innertd {
        margin: 0 !important;
    }
</style>